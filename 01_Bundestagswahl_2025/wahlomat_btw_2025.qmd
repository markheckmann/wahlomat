---
title: "Parteien und Thesen des 'Wahl-O-Mat' 2025"
format: 
  html:
    self-contained: true
execute:
  keep-md: true
---

```{r include=FALSE}
library(readxl)
library(tidyverse)
library(OpenRepGrid)
library(janitor)
library(openxlsx)
library(flextable)

file_in <- "data/wide_format.xlsx"
grid_file <- "data/grid.xlsx"
```

```{r echo=FALSE}
g <- importExcel(grid_file)
thesen <- rightpoles(g)
rightpoles(g) <- paste("↑", thesen)
leftpoles(g) <- paste(thesen, "↓")

parteien_auswahl <- c(1, 2, 3, 4, 5, 6, 8, 14, 25, 28, 26)
ga <- g[, parteien_auswahl]
```

## Antworten zu den Thesen 

Nachfolgende Grafik ist eine Darstellung der Position der Parteien zu den 38 im Wahl-O-Mat anfgefragten politischen Thesen, wobei Zustimmung und Ablehnung durch Farben (grün/rot) dargestellt werden. Sie ermöglicht einen schnellen Vergleich der Parteipositionen zu verschiedenen Thesen. Sie zeigt, welche Parteien inhaltlich nah beieinander liegen und welche Unterschiede aufweisen. Die Spalten sind so sortiert, dass Parteien mit ählichen Antworten nebeneinander stehen. Die Zeilen sind so sortiert, dass Thesen bei denen die Parteien ähnlich geantwortet haben untereinander stehen.

**Lesehilfe**

- *Spalten (Parteien)*: Jede Spalte repräsentiert eine Partei (z. B. SPD, CDU/CSU, AfD).
- *Zeilen (Thesen)*: Jede Zeile steht für eine politische These (Kurzform), z. B. "Tempolimit auf Autobahnen" oder "Erhöhung des Mindestlohns". Die ausführliche Formulierung der These finden Sie in der Tabelle weiter unten.
- Farben:
  - *Grün*: Die Partei unterstützt die These.
  - *Rot*: Die Partei lehnt die These ab.
  - *Neutral* (dunkle Farbe): neutrale Position.


```{r include=FALSE, echo=FALSE, fig.width = 9, fig.height=9}
bertinCluster(ga,
  align = FALSE,
  colors = c("red", "green"),
  showvalues = FALSE,
  xsegs = c(0, 0.3, 0.6, 0.9, 1),
  ysegs = c(0, 0.1, 0.825, 1)
)
```

```{r echo=FALSE, fig.width = 10, fig.height=10, out.width=800, out.height=800}
# weitere Variante
ga_2d <- reorder2d(ga)
e_ii <- 1:11 # c(8:11, 1:7)
e_ii <- rev(c(2:1, 11:3)) # rotieren links - rechts
bertin(ga_2d[, e_ii],
  align = FALSE,
  colors = c("red", "green"),
  showvalues = FALSE,
  xlim = c(.3, .7),
  ylim = c(0, .8)
)
```


## Räumliche Darstellung

Die Darstellung unten ist ein *Biplot*. Dies ist eine Variante des Streudiagramms jedoch mit mehr als zwei Achsen. Er ermöglicht sowohl die Beziehungen zwischen den Thesen als auch zwischen den Parteien in einem Bild darzustellen. So interpretiert man die Grafik:

*Punkte (Parteien)*

Die Punkte repräsentieren die Parteien. Ihre Positionen im Raum zeigt zum einen, wie sie in Bezug auf die dargestellten Thesen geantwortet haben. Weiterhin haben Parteien, die nah beieinander sind, tendenziell ähnlich geantwortet.

*Achsen (Thesen)*

Die Achsen repräsentieren die politischen Thesen. Thesen weisen in eine ähnliche Richtung, wenn das Antwortmuster der Parteien auf diesen ähnlich ist. Wenn man das Lot von einer Partei (der Punkt) auf eine Achse (These) fällt, kann man tendenziell ablesen, ob die Partei eher zustimmend oder ablehnend war. Die Mitte (Ursprung des Koordinatensystems) ist das neutrale Zentrum.

```{r echo=FALSE, fig.width = 7, fig.height=7}
biplot2d(ga, center = 0, mai = c(1, 2, 1, 2), flipaxes = c(FALSE, FALSE), c.label.col = "blue")
# biplot3d(ga)
```


```{r echo=FALSE}
df <- read_excel(file_in)
df |>
  select(these_titel:these_these) |>
  arrange(these_titel) |> 
  flextable(cwidth = c(2,5)) |> 
  set_header_labels(values = c("Kurzform", "These")) 
```
